# Bandit Security Scanning - Exclude Patterns and Best Practices

## Overview

This document outlines the exclude patterns implemented for Bandit security scanning across the project, following industry best practices for Python security analysis.

## Current Implementation

### Enhanced Exclude Pattern

The following directories and files are excluded from Bandit security scans:

```bash
./venv/*,./.venv/*,./env/*,./ENV/*,./venv*/*,./tests/*,./test/*,./node_modules/*,./htmlcov/*,./workflow_outputs/*,./build/*,./dist/*,./target/*,./.mypy_cache/*,./.pytest_cache/*,./.ruff_cache/*,./.hypothesis/*,./.vscode/*,./.idea/*,./docs/_build/*,./site/*,./tmp/*,./temp/*,./output/*,*.egg-info/*
```

### Categories of Excluded Directories

#### 1. Virtual Environments
- `./venv/*`, `./.venv/*`, `./env/*`, `./ENV/*`, `./venv*/*`
- **Rationale**: Contains third-party packages that should be scanned separately via dependency scanning tools

#### 2. Test Directories
- `./tests/*`, `./test/*`
- **Rationale**: May contain intentionally vulnerable code for testing security features

#### 3. Build and Distribution Artifacts
- `./build/*`, `./dist/*`, `./target/*`, `*.egg-info/*`
- **Rationale**: Generated files, not source code that developers write

#### 4. Cache Directories
- `./.mypy_cache/*`, `./.pytest_cache/*`, `./.ruff_cache/*`, `./.hypothesis/*`
- **Rationale**: Temporary files generated by tools, not source code

#### 5. IDE and Editor Directories
- `./.vscode/*`, `./.idea/*`
- **Rationale**: Configuration files, not application source code

#### 6. Documentation Build Directories
- `./docs/_build/*`, `./site/*`
- **Rationale**: Generated documentation, not source code

#### 7. Coverage and Output Directories
- `./htmlcov/*`, `./workflow_outputs/*`, `./output/*`
- **Rationale**: Generated reports and outputs

#### 8. Temporary Directories
- `./tmp/*`, `./temp/*`
- **Rationale**: Temporary files that shouldn't contain production code

#### 9. Node.js Dependencies (Hybrid Projects)
- `./node_modules/*`
- **Rationale**: JavaScript dependencies in hybrid Python/JS projects

## Files Updated

### 1. `scripts/generate_sarif_reports.py`
- Updated both `run_bandit_sarif()` and `_convert_bandit_json_to_sarif()` methods
- Centralized exclude pattern definition
- Fixed linting issues (unused variables, Path.open() usage)

### 2. GitHub Actions Workflows
- `.github/workflows/dependency-check.yml`
- `.github/workflows/security-enhanced.yml`
- `.github/workflows/monitoring.yml`

### 3. Configuration Files
- `.bandit.yaml` - Enhanced with comprehensive exclude patterns and documentation
- `.pre-commit-config.yaml` - Updated global exclude pattern

## Security Benefits

### 1. **Reduced False Positives**
- Excludes test code that may intentionally contain vulnerable patterns
- Avoids scanning generated/third-party code

### 2. **Improved Performance**
- Faster scans by excluding large directories (node_modules, cache directories)
- More focused analysis on actual source code

### 3. **Better Signal-to-Noise Ratio**
- Focus on code that developers actually write and maintain
- Exclude dependencies (handled by separate dependency scanning)

### 4. **Consistency Across Environments**
- Same patterns used in local development, pre-commit hooks, and CI/CD
- Standardized approach following industry best practices

## Best Practices Followed

### 1. **Separation of Concerns**
- Source code security (Bandit) vs dependency security (pip-audit, Safety)
- Different tools for different types of security analysis

### 2. **Defense in Depth**
- Multiple security tools (Bandit, Semgrep, Ruff S-rules)
- Different scanning approaches (static analysis, dependency scanning)

### 3. **Developer Experience**
- Fast local scans encourage frequent security checking
- Clear documentation of what is and isn't scanned

### 4. **CI/CD Integration**
- Consistent patterns across all automation
- SARIF output for GitHub Security tab integration

## Configuration Management

### Centralized Configuration
The `.bandit.yaml` file serves as the central configuration:

```yaml
exclude_dirs:
  - "/tests/"
  - "/venv/"
  # ... (see full file for complete list)

confidence: MEDIUM
severity: LOW
```

### Command-Line Override
For specific use cases, the exclude pattern can be overridden:

```bash
bandit -r . --exclude "custom/pattern/*"
```

## Monitoring and Maintenance

### Regular Review
- Review exclude patterns quarterly
- Update based on new project structure changes
- Monitor for new types of generated directories

### Tool Updates
- Keep Bandit version updated
- Review new Bandit rules and configurations
- Align with security team recommendations

## Related Documentation

- [Security Scanning Overview](../security-scanning.md)
- [Pre-commit Hooks Configuration](../development/pre-commit.md)
- [CI/CD Security Integration](../ci-cd/security.md) 